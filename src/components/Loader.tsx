import { useEffect, useRef } from "react";
import gsap from "gsap";

const Loader = ({ onComplete }: { onComplete: () => void }) => {
  const containerRef = useRef<HTMLDivElement>(null);
  const svgRef = useRef<SVGSVGElement>(null);

  useEffect(() => {
    if (!svgRef.current || !containerRef.current) return;

    const paths = svgRef.current.querySelectorAll("path");

    const tl = gsap.timeline({
      onComplete: () => {
        // Fade out the entire loader once finished
        gsap.to(containerRef.current, {
          opacity: 0,
          duration: 0.8,
          delay: 0.5,
          onComplete,
        });
      },
    });

    // 1. Prepare the paths: No fill, just stroke
    gsap.set(paths, {
      fillOpacity: 0,
      stroke: "white", // Change to your brand color
      strokeWidth: 0.5,
      strokeDasharray: 800,
      strokeDashoffset: 800,
    });

    // 2. Animate the stroke (The "Writing" phase)
    tl.to(paths, {
      strokeDashoffset: 0,
      duration: 2.5,
      ease: "power1.inOut",
      stagger: 0.05, // Letters appear one after another
    })
    // 3. Animate the fill (The "Ink Bleed" phase)
    .to(paths, {
      fillOpacity: 1,
      fill: "white", // The final color of your text
      duration: 1,
      ease: "power2.out",
    }, "-=1"); // Start filling before stroke finishes

  }, [onComplete]);

  return (
    <div
      ref={containerRef}
      className="fixed inset-0 z-50 flex items-center justify-center bg-black"
    >
      <svg
        ref={svgRef}
        viewBox="0 9.4 381.8 38.5"
        className="w-[90vw] max-w-[800px] h-auto"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g fill="#ffffff"><g transform="translate(0, 0)"><path d="M24.30 12.50Q25.05 11.30 26.60 11.30Q27.20 11.30 27.70 11.60Q28.05 17.05 28.05 22.35Q28.05 27.65 27.82 35.80Q27.60 43.95 27.55 46.35Q26.35 47.15 25.60 47.15Q24.85 47.15 24.45 47Q24.15 44.35 24.15 41.60L24.45 30.20Q20.15 29.80 14.85 29.80Q9.55 29.80 3.80 30.85Q3.40 40.75 3.40 45.45Q2.15 46.45 1.38 46.45Q0.60 46.45 0.15 46.20Q0 43.75 0 39.30Q0 34.85 0.63 24.58Q1.25 14.30 1.30 12.70Q1.95 11.65 3.55 11.65Q4.05 11.65 4.50 11.85Q4.65 13.25 4.65 15.40Q4.65 17.55 4.35 21.98Q4.05 26.40 4.05 28.10Q10.10 27.10 15.25 27.10Q20.40 27.10 24.35 27.45Q24.50 25.60 24.50 22Q24.50 18.40 24.30 12.50ZM50.40 32.30L50.15 38.05Q50.15 42.40 51.15 43.90Q51.75 44.90 52.80 44.90Q53.10 44.90 53.65 44.75Q54.70 44.45 55.40 45.05Q55.05 46.80 51.90 46.80Q49.75 46.80 49.05 45Q48.50 43.65 48.25 41.63Q48 39.60 47.85 38.85Q44.60 45.05 41.55 46.40Q40 47.10 37.95 47.10Q35.90 47.10 34.78 45.13Q33.65 43.15 33.65 39.35Q33.65 35.55 34.90 31.38Q36.15 27.20 38.55 24.33Q40.95 21.45 43.80 21.45Q47.90 21.45 49.25 24.85Q50.40 27.75 50.40 32.30M38.15 30.68Q38.15 30.68 37.80 32.04Q37.45 33.40 37.10 35.83Q36.75 38.25 36.75 40.13Q36.75 42 37.53 43.35Q38.30 44.70 39.55 44.70Q42.25 44.70 44.75 39.60Q47.25 34.50 47.25 30.10Q47.25 27.25 45.75 25.40Q44.75 24.20 43.13 24.20Q41.50 24.20 40.18 26.08Q38.85 27.95 38.15 30.68ZM69.60 26.70Q69.15 25.55 67.90 24.90Q66.65 24.25 64.80 24.25Q62.95 24.25 61.33 25.35Q59.70 26.45 59.70 28.30Q59.70 30.15 61.23 31.23Q62.75 32.30 64.93 32.85Q67.10 33.40 69.30 34.03Q71.50 34.65 73.03 36.08Q74.55 37.50 74.55 39.80Q74.55 43.15 71.78 44.90Q69.00 46.65 65.10 46.65Q62.80 46.65 59.08 45.40Q55.35 44.15 55.35 42.40Q55.35 41.10 57.55 41.10Q58.20 41.10 59.25 41.90Q62.45 44.25 65.80 44.25Q67.60 44.25 68.90 43.65Q71.30 42.50 71.30 39.95Q71.30 38.40 69.78 37.45Q68.25 36.50 66.08 35.95Q63.90 35.40 61.70 34.75Q59.50 34.10 57.98 32.58Q56.45 31.05 56.45 28.70Q56.45 25.65 59.20 23.75Q61.95 21.85 66.00 21.85Q68.75 21.85 70.98 23.28Q73.20 24.70 73.20 27.40Q73.20 29.20 71.15 29.20Q70.30 29.20 70.03 28.90Q69.75 28.60 69.73 27.83Q69.70 27.05 69.60 26.70ZM91.40 26.70Q90.95 25.55 89.70 24.90Q88.45 24.25 86.60 24.25Q84.75 24.25 83.13 25.35Q81.50 26.45 81.50 28.30Q81.50 30.15 83.03 31.23Q84.55 32.30 86.73 32.85Q88.90 33.40 91.10 34.03Q93.30 34.65 94.83 36.08Q96.35 37.50 96.35 39.80Q96.35 43.15 93.58 44.90Q90.80 46.65 86.90 46.65Q84.60 46.65 80.88 45.40Q77.15 44.15 77.15 42.40Q77.15 41.10 79.35 41.10Q80 41.10 81.05 41.90Q84.25 44.25 87.60 44.25Q89.40 44.25 90.70 43.65Q93.10 42.50 93.10 39.95Q93.10 38.40 91.58 37.45Q90.05 36.50 87.88 35.95Q85.70 35.40 83.50 34.75Q81.30 34.10 79.78 32.58Q78.25 31.05 78.25 28.70Q78.25 25.65 81 23.75Q83.75 21.85 87.80 21.85Q90.55 21.85 92.78 23.28Q95 24.70 95 27.40Q95 29.20 92.95 29.20Q92.10 29.20 91.83 28.90Q91.55 28.60 91.53 27.83Q91.50 27.05 91.40 26.70ZM116.45 32.30L116.20 38.05Q116.20 42.40 117.20 43.90Q117.80 44.90 118.85 44.90Q119.15 44.90 119.70 44.75Q120.75 44.45 121.45 45.05Q121.10 46.80 117.95 46.80Q115.80 46.80 115.10 45Q114.55 43.65 114.30 41.63Q114.05 39.60 113.90 38.85Q110.65 45.05 107.60 46.40Q106.05 47.10 104 47.10Q101.95 47.10 100.83 45.13Q99.70 43.15 99.70 39.35Q99.70 35.55 100.95 31.38Q102.20 27.20 104.60 24.33Q107 21.45 109.85 21.45Q113.95 21.45 115.30 24.85Q116.45 27.75 116.45 32.30M104.20 30.68Q104.20 30.68 103.85 32.04Q103.50 33.40 103.15 35.83Q102.80 38.25 102.80 40.13Q102.80 42 103.58 43.35Q104.35 44.70 105.60 44.70Q108.30 44.70 110.80 39.60Q113.30 34.50 113.30 30.10Q113.30 27.25 111.80 25.40Q110.80 24.20 109.18 24.20Q107.55 24.20 106.23 26.08Q104.90 27.95 104.20 30.68ZM143.65 45.30Q142.75 46.25 141.60 46.25Q139.45 46.25 138.40 43.95Q137.35 41.65 137.18 38.35Q137 35.05 136.95 31.75Q136.90 28.45 136.43 26.15Q135.95 23.85 134.65 23.85Q132.90 23.85 131.68 27Q130.45 30.15 129.95 34Q128.55 44.75 127.25 46.05Q126.35 46.50 125.70 46.50Q125.05 46.50 124.60 46.35Q123.55 41.75 123.25 30.50Q123.15 24.90 123.05 23.25Q124.10 22.55 124.85 22.55Q125.60 22.55 126.05 22.70Q126.30 24.85 126.33 31.50Q126.35 38.15 126.40 39.15Q126.65 38.10 127.03 35.75Q127.40 33.40 127.70 31.88Q128 30.35 128.65 28.30Q129.30 26.25 130.10 25.03Q130.90 23.80 132.30 22.93Q133.70 22.05 135.45 22.05Q137.80 22.05 138.88 24.18Q139.95 26.30 140.05 29.45Q140.15 32.60 140.18 35.85Q140.20 39.10 140.98 41.80Q141.75 44.50 143.65 45.30ZM162.75 37.10L162.90 44.65Q162.90 46.20 162.20 46.75Q161.50 47.30 160.90 47.30Q160.30 47.30 159.75 47.15Q159.10 41.80 159.10 36.70Q159.10 31.60 159.43 25.15Q159.75 18.70 159.80 14.95Q159.80 10.95 170.50 10.95Q176.15 10.95 181.15 13.30Q183.75 14.50 185.40 16.68Q187.05 18.85 187.05 21.53Q187.05 24.20 185.85 26.35Q184.65 28.50 182.80 29.93Q180.95 31.35 178.55 32.40Q174.60 34.20 169.75 34.80Q172.15 36.15 177.55 41.30Q179.15 42.85 181.60 44.08Q184.05 45.30 186.65 45.30Q186.90 45.30 187.70 45.18Q188.50 45.05 189.05 45Q189.60 44.95 190.08 45.23Q190.55 45.50 190.55 46.20Q190.55 47.90 186.30 47.90Q181.35 47.90 176.45 44.10Q174.30 42.50 172.25 40.80Q167.20 36.55 162.80 35.45Q162.75 35.90 162.75 37.10M183.30 22.15Q183.30 17.95 179.53 15.83Q175.75 13.70 169.95 13.70Q166.30 13.70 163.15 14.50Q163.15 18.45 162.90 23.28Q162.65 28.10 162.65 29.90Q162.65 31.70 162.70 32.55Q170.10 32 174.15 30.80Q178.50 29.55 180.65 27.70Q183.30 25.40 183.30 22.15ZM208.65 32.30L208.40 38.05Q208.40 42.40 209.40 43.90Q210.00 44.90 211.05 44.90Q211.35 44.90 211.90 44.75Q212.95 44.45 213.65 45.05Q213.30 46.80 210.15 46.80Q208.00 46.80 207.30 45Q206.75 43.65 206.50 41.63Q206.25 39.60 206.10 38.85Q202.85 45.05 199.80 46.40Q198.25 47.10 196.20 47.10Q194.15 47.10 193.03 45.13Q191.90 43.15 191.90 39.35Q191.90 35.55 193.15 31.38Q194.40 27.20 196.80 24.33Q199.20 21.45 202.05 21.45Q206.15 21.45 207.50 24.85Q208.65 27.75 208.65 32.30M196.40 30.68Q196.40 30.68 196.05 32.04Q195.70 33.40 195.35 35.83Q195.00 38.25 195.00 40.13Q195.00 42 195.78 43.35Q196.55 44.70 197.80 44.70Q200.50 44.70 203.00 39.60Q205.50 34.50 205.50 30.10Q205.50 27.25 204.00 25.40Q203.00 24.20 201.38 24.20Q199.75 24.20 198.43 26.08Q197.10 27.95 196.40 30.68ZM219.75 43.30Q227.40 42.65 230.45 42.65Q233.50 42.65 233.50 44.10Q233.50 45.15 232.35 45.35Q231.45 45.50 228.63 45.50Q225.80 45.50 221.48 45.83Q217.15 46.15 215.68 46.15Q214.20 46.15 214.20 45.30Q214.20 44.10 217.35 41.25L220.35 38.20Q222.60 35.90 224.00 34.33Q225.40 32.75 226.78 30.55Q228.15 28.35 228.15 26.85Q228.15 24.80 224.70 24.80Q223.05 24.80 219.88 25.40Q216.70 26 215.10 26Q213.50 26 213.50 24.90Q213.50 23.50 218.03 22.78Q222.55 22.05 225.80 22.05Q231.55 22.05 231.55 25.60Q231.55 27.95 229.48 31.23Q227.40 34.50 223.73 38.70Q220.05 42.90 219.75 43.30ZM253.10 32.30L252.85 38.05Q252.85 42.40 253.85 43.90Q254.45 44.90 255.50 44.90Q255.80 44.90 256.35 44.75Q257.40 44.45 258.10 45.05Q257.75 46.80 254.60 46.80Q252.45 46.80 251.75 45Q251.20 43.65 250.95 41.63Q250.70 39.60 250.55 38.85Q247.30 45.05 244.25 46.40Q242.70 47.10 240.65 47.10Q238.60 47.10 237.48 45.13Q236.35 43.15 236.35 39.35Q236.35 35.55 237.60 31.38Q238.85 27.20 241.25 24.33Q243.65 21.45 246.50 21.45Q250.60 21.45 251.95 24.85Q253.10 27.75 253.10 32.30M240.85 30.68Q240.85 30.68 240.50 32.04Q240.15 33.40 239.80 35.83Q239.45 38.25 239.45 40.13Q239.45 42 240.23 43.35Q241.00 44.70 242.25 44.70Q244.95 44.70 247.45 39.60Q249.95 34.50 249.95 30.10Q249.95 27.25 248.45 25.40Q247.45 24.20 245.83 24.20Q244.20 24.20 242.88 26.08Q241.55 27.95 240.85 30.68ZM289.05 31.45Q286.25 31.45 286.25 30.50Q286.25 29.40 289.70 28.78Q293.15 28.15 296.70 28.15Q300.25 28.15 301.85 28.35Q303.45 28.55 303.93 28.90Q304.40 29.25 304.40 29.90Q304.40 38.90 300.10 43.15Q295.80 47.40 287.73 47.40Q279.65 47.40 275.08 43.45Q270.50 39.50 270.50 32.55Q270.50 22.95 276.25 16.98Q282 11 290.55 11Q294.30 11 297.65 12.55Q301 14.10 301.75 16.55Q301.05 17.15 300.40 17.15Q299.75 17.15 298.83 16.85Q297.90 16.55 296.95 15.70Q296 14.85 294.05 13.98Q292.10 13.10 289.95 13.10Q283.30 13.10 278.43 18.78Q273.55 24.45 273.55 32.15Q273.55 38.25 278.03 41.70Q282.50 45.15 288.50 45.15Q295.35 45.15 298.20 40.90Q300.90 37 300.90 30.95Q300.50 30.60 299.85 30.60Q299.20 30.60 298.30 30.65Q296 30.75 293 31.10Q290 31.45 289.05 31.45ZM309.40 36.35L309.85 13.95Q309.85 11.35 309.55 10.40Q310.45 9.60 312.30 9.60Q313.05 14.95 313.05 23.35Q313.05 25.85 312.60 34.95Q314.95 22.30 321.00 22.30Q323.15 22.30 324.33 24.58Q325.50 26.85 325.80 30.10Q326.10 33.35 326.30 36.60Q326.80 44.40 329.10 44.40Q329.15 44.40 330.05 44.10Q332.05 43.50 332.30 43.80Q332.30 44.35 330.75 45.18Q329.20 46 327.90 46Q325.70 46 324.53 43.73Q323.35 41.45 323.08 38.20Q322.80 34.95 322.68 31.73Q322.55 28.50 322.00 26.23Q321.45 23.95 320.15 23.95Q318.55 23.95 317.23 27.43Q315.90 30.90 315.15 35.10Q314.40 39.30 313.33 42.78Q312.25 46.25 311.15 46.25Q309.40 46.25 309.40 36.35ZM349.30 32.30L349.05 38.05Q349.05 42.40 350.05 43.90Q350.65 44.90 351.70 44.90Q352 44.90 352.55 44.75Q353.60 44.45 354.30 45.05Q353.95 46.80 350.80 46.80Q348.65 46.80 347.95 45Q347.40 43.65 347.15 41.63Q346.90 39.60 346.75 38.85Q343.50 45.05 340.45 46.40Q338.90 47.10 336.85 47.10Q334.80 47.10 333.68 45.13Q332.55 43.15 332.55 39.35Q332.55 35.55 333.80 31.38Q335.05 27.20 337.45 24.33Q339.85 21.45 342.70 21.45Q346.80 21.45 348.15 24.85Q349.30 27.75 349.30 32.30M337.05 30.68Q337.05 30.68 336.70 32.04Q336.35 33.40 336 35.83Q335.65 38.25 335.65 40.13Q335.65 42 336.43 43.35Q337.20 44.70 338.45 44.70Q341.15 44.70 343.65 39.60Q346.15 34.50 346.15 30.10Q346.15 27.25 344.65 25.40Q343.65 24.20 342.03 24.20Q340.40 24.20 339.07 26.08Q337.75 27.95 337.05 30.68ZM360.40 43.30Q368.05 42.65 371.10 42.65Q374.15 42.65 374.15 44.10Q374.15 45.15 373 45.35Q372.10 45.50 369.27 45.50Q366.45 45.50 362.13 45.83Q357.80 46.15 356.32 46.15Q354.85 46.15 354.85 45.30Q354.85 44.10 358 41.25L361 38.20Q363.25 35.90 364.65 34.33Q366.05 32.75 367.43 30.55Q368.80 28.35 368.80 26.85Q368.80 24.80 365.35 24.80Q363.70 24.80 360.52 25.40Q357.35 26 355.75 26Q354.15 26 354.15 24.90Q354.15 23.50 358.68 22.78Q363.20 22.05 366.45 22.05Q372.20 22.05 372.20 25.60Q372.20 27.95 370.13 31.23Q368.05 34.50 364.38 38.70Q360.70 42.90 360.40 43.30ZM381.50 9.90Q381.45 11.05 381.45 12.45Q381.45 13.85 381.60 15.35Q380.90 16.15 379.70 16.15Q378.20 16.15 378.20 13.75Q378.20 13.65 378.20 13Q378.20 12.35 378.23 11.83Q378.25 11.30 378.40 10.60Q378.75 9.40 379.95 9.40Q381.15 9.40 381.50 9.90M378.30 34.40Q378.30 24.60 379.30 23.10Q379.65 22.55 380.15 22.55Q380.65 22.55 381.80 23.10Q381.55 27.35 381.55 32.35Q381.55 32.35 381.65 43.40Q381.65 44.95 380.98 45.58Q380.30 46.20 379.73 46.20Q379.15 46.20 378.55 45.90Q378.30 39.40 378.30 34.40Z"/></g></g>
      </svg>
    </div>
  );
};

export default Loader;